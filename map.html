<!doctype html>
<html>
    <head>
        <title>Teleports - The digital teleporter</title>

        <meta charset="utf-8">
        <meta name=viewport content="width=device-width, initial-scale=1">
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">

        <link rel="icon" sizes="192x192" href="imgs/icon_192.png">
        <link rel="icon" sizes="128x128" href="imgs/icon_128.png">
        <link rel="apple-touch-icon" sizes="128x128" href="imgs/icon_128.png">
        <link rel="apple-touch-icon-precomposed" sizes="128x128" href="imgs/icon_128.png">
        <link rel="manifest" href="manifest.json">

        <meta property="og:title" content="Teleports.me" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="http://teleports.me" />
        <meta property="og:image" content="http://teleports.me/imgs/icon_192.png" />
        <meta property="og:description" content="Teleports.me allows you to create and share a virtual reality location with your friends" />
        <meta property="og:site_name" content="Teleports.me" />

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.css" />
        <style>
            #map {
                height: 100%;
                height: 100vh;
            }
        </style>
    </head>
    <body>
        <div id="map"></div>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.js"></script>
        <script>
            var map = L.map('map').setView([47.367347, 8.5500025], 2);

            L.tileLayer('https://{s}.tiles.mapbox.com/v4/teleports.lm7m9iek/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoidGVsZXBvcnRzIiwiYSI6IjEwd1NOaDQifQ.CgyC_tRLY2dYpoPpk-nklg', {
                attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
                maxZoom: 18
            }).addTo(map);

            var xhr = new XMLHttpRequest();
            xhr.onload = function() {
                var teleports = JSON.parse(this.responseText);
                for(var i=0; i<teleports.length; i++) {
                  if(teleports[i].lat === null) continue;

                  var marker = L.marker([teleports[i].lat, teleports[i].lng]).addTo(map);
                  marker.bindPopup("<a href=\"http://teleports.me/#show=" + teleports[i].file + "\">Click here to see this Teleport</a>");
                }
            };
            xhr.open('get', 'http://uploads.teleports.me/spots', false);
            xhr.send();

        </script>
    </body>
</html>
